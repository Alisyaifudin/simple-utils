var u=(r,t,e)=>new Promise((n,o)=>{var c=i=>{try{l(e.next(i))}catch(a){o(a)}},s=i=>{try{l(e.throw(i))}catch(a){o(a)}},l=i=>i.done?n(i.value):Promise.resolve(i.value).then(c,s);l((e=e.apply(r,t)).next())});import{getElement as p}from"./share/element.js";import{state$ as M}from"./share/state$.js";function f(r,t){return function(){return u(this,null,function*(){let e=r.files;e===null||e.length===0||(t.setter(n=>(n.push(...e),n)),r.files=null,r.value="")})}}function h(r,t){r.addEffect(e=>{t.innerHTML="",e.forEach((n,o)=>{let c=document.createElement("li");c.classList.add("flex","items-center","gap-1"),o%2===1&&c.classList.add("bg-card/50");let s=document.createElement("div");if(s.classList.add("flex","flex-1","items-center","gap-1"),o>0){let d=L(r,o);s.appendChild(d)}if(o<e.length-1){let d=E(r,o);s.appendChild(d)}let l=document.createElement("p"),i=String(o+1)+". "+n.name;l.textContent=i,s.appendChild(l),c.appendChild(s);let a=k(r,o);c.appendChild(a),t.appendChild(c)})})}function L(r,t){let e=document.createElement("button");return e.classList.add("p-0","bg-card","border-border","border","rounded-full","h-7","w-7"),e.type="button",e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-up-icon lucide-chevron-up"><path d="m18 15-6-6-6 6"/></svg>',e.addEventListener("click",()=>{t!==0&&r.setter(n=>([n[t-1],n[t]]=[n[t],n[t-1]],n))}),e}function E(r,t){let e=document.createElement("button");return e.classList.add("p-0","bg-card","border-border","border","rounded-full","h-7","w-7"),e.type="button",e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down-icon lucide-chevron-down"><path d="m6 9 6 6 6-6"/></svg>',e.addEventListener("click",()=>{t!==r.get.length-1&&r.setter(n=>([n[t+1],n[t]]=[n[t],n[t+1]],n))}),e}function k(r,t){let e=document.createElement("button");return e.classList.add("p-0","bg-destructive","border-border","border","rounded-full","h-7","w-7"),e.type="button",e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x-icon lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>',e.addEventListener("click",()=>{r.setter(n=>(n.splice(t,1),n))}),e}import{getElement as x}from"./share/element.js";import{PDFDocument as g}from"./share/pdfjs.js";import{err as F,ok as S}from"./share/utils.js";function w(r){let t=x("#pdf-status");return function(e){return u(this,null,function*(){if(e.preventDefault(),r.get.length===0)return;t.textContent="Loading...";let[n,o]=yield C(r.get);if(n!==null){t.textContent=n;return}let c=URL.createObjectURL(o),s=document.createElement("a");s.href=c,s.download=`merge-${Date.now()}.pdf`,s.click(),URL.revokeObjectURL(c),t.textContent="Successful"})}}function y(r){return u(this,null,function*(){let t=yield r.arrayBuffer();return yield g.load(t)})}function C(r){return u(this,null,function*(){let t=r.map(a=>y(a)),e=yield Promise.allSettled(t),n=!1,o=[],c=[];if(e.forEach((a,d)=>{if(a.status==="rejected"){n=!0,o.push([`Something went wrong at ${r[d].name}`,a.reason]);return}c.push(a.value)}),n)return F(JSON.stringify(o));let s=yield g.create();for(let a of c)(yield s.copyPages(a,a.getPageIndices())).forEach(v=>s.addPage(v));let l=yield s.save(),i=new Blob([l],{type:"application/pdf"});return S(i)})}var b=p("#pdf-input"),m=M([]),P=p("form"),D=p("#file-list");b.addEventListener("change",f(b,m));h(m,D);P.addEventListener("submit",w(m));
